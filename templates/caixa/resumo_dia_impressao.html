<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Resumo do Dia - Impressão</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        @media print {
            body { font-size: 11pt; margin: 0; padding: 15mm; }
            .no-print { display: none !important; }
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20mm; }
        .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        th, td { border: 1px solid #000; padding: 6px; text-align: left; }
        th { background-color: #f2f2f2; }
        .footer { margin-top: 30px; text-align: center; font-size: 0.8rem; }
    </style>
</head>
<body>

<div class="header">
    <h2>RESUMO DO DIA</h2>
    <p><strong>Data:</strong> {{ hoje.strftime('%d/%m/%Y') }} | <strong>Loja:</strong> 01</p>
</div>

{% for caixa in caixas %}
<div class="caixa-secao">
    <h5>Caixa {{ loop.index }} - Usuário: {{ caixa.cai_usuario_abertura }}</h5>
    <table>
        <tr><th>Item</th><th>Valor (R$)</th></tr>
        <tr><td>Saldo Inicial</td><td>{{ "%.2f"|format(caixa.cai_saldo_inicial)|replace('.', ',') }}</td></tr>
        <tr><td>Dinheiro</td><td>{{ "%.2f"|format(caixa.cai_dinheiro_caixa)|replace('.', ',') }}</td></tr>
        <tr><td>Cartão</td><td>{{ "%.2f"|format(caixa.cai_cartao_caixa)|replace('.', ',') }}</td></tr>
        <tr><td>PIX</td><td>{{ "%.2f"|format(caixa.cai_pix_caixa)|replace('.', ',') }}</td></tr>
        <tr><td>Cheque</td><td>{{ "%.2f"|format(caixa.cai_cheque_caixa)|replace('.', ',') }}</td></tr>
        <tr><td>Retiradas</td><td>{{ "%.2f"|format(caixa.cai_dinheiro_retrada + caixa.cai_cheque_retrada)|replace('.', ',') }}</td></tr>
        <tr><td><strong>Total Conferência</strong></td><td><strong>{{ "%.2f"|format(caixa.cai_total_conferencia)|replace('.', ',') }}</strong></td></tr>
    </table>
    
    {% if caixa.cai_observacao %}
        <p><strong>Observações:</strong> {{ caixa.cai_observacao }}</p>
    {% endif %}
    <hr>
</div>
{% endfor %}

<div class="footer no-print">
    <p>Documento gerado automaticamente. Não necessita de assinatura.</p>
</div>

<script>
window.onload = function() {
    window.print();
    setTimeout(function() {
        window.close(); // Fecha a janela após imprimir
    }, 3000);
};
</script>
</body>
</html>